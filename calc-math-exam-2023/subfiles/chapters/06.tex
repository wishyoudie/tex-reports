\section{Интерполяционный полином Лагранжа. Остаточный член полинома Лагранжа.}\label{sec:ch06}
Непосредственное численное решение представляет значительные трудности.
С одной стороны, это связано с заметным объемом вычислений для нахождения
$a_k$. С другой стороны, малое изменение данных таблицы $\left( x_k, f(x_k) \right)$
часто приводит к сильному изменению решения (особенно для близко расположенных узлов
интерполирования). В связи с этим, попробуем построить полином, не прибегая к решению системы.

С этой целью введем следующие функции:
\begin{flalign*}
    &\omega(x) = \left( x - x_0 \right)\left( x - x_1 \right) \dots \left( x - x_m \right)\\
    &\omega_k(x) = \frac{\omega(x)}{(x - x_k)} = \left( x - x_0 \right)\left( x - x_1 \right) \dots \left( x - x_{k-1} \right)\left( x - x_{k+1} \right) \dots \left( x - x_m \right)
\end{flalign*}
В этих обозначениях запишем следующий полином
\begin{definition}[Интерполяционный полином Лагранжа]
    \begin{equation}
        Q_m(x) = \sum_{k=0}^m \frac{\omega_k(x)}{\omega_k(x_k)} f(x_k)
    \end{equation}
\end{definition}
По построению это многочлен степени $m$. Определим его значения в узлах интерполирования
$x_i$. Так как для $x = x_i$ полином $\omega_k(x)$ равен нулю, если только
$i \neq k$, то для $Q_m(x_i)$ получаем
\begin{equation*}
    Q_m(x_i) = \sum_{k=0}^{m} \frac{\omega_k(x_i)}{\omega_k(x_k)} f(x_k) = \frac{\omega_i(x_i)}{\omega_i(x_i)} f(x_i) = f(x_i), \qquad i = 0,1,\dots,m
\end{equation*}
То есть в узлах интерполяции значения полинома совпадают со значениями функции.

Теперь обратимся к погрешности интерполяционного полинома. Исходная функция $f(x)$
может быть представлена в виде
\begin{equation*}
    f(x) = Q_m(x) + R_m(x)
\end{equation*}
где $Q_m(x)$ -- интерполяционный полином, а $R_m(x)$ носит название \emph{остаточного члена интерполяционного полинома}.

\begin{theorem}[Об остаточном члене полинома Лагранжа]
    Пусть $f(x)$ на промежутке $[a, b]$ имеет непрерывные производные вплоть до
    $m+1$ порядка, то остаточный член $R_m(x)$ можно представить в виде:
    \begin{equation}
        R_m(x) = f(x) - Q_m(x) = \frac{\displaystyle f^{(m+1)}(\eta)}{(m+1)!}\omega(x), \qquad \eta \in [a, b]
    \end{equation}
    При этом $\omega(x)$ определяется как и прежде.

    \emph{Доказательство.} Рассмотрим вспомогательную функцию
    \begin{equation}
        \varphi(z) = f(z) - Q_m(z) - K\omega(z)\label{eq:lagrange_proof_help_func}
    \end{equation}
    где $K$ -- некоторая постоянная. Пусть $x_k$ -- узлы интерполирования, а $x$ -- точка,
    в которой оценивается погрешность $(x \neq x_k)$. Легко заметить, что функция $\varphi(z)$
    равна нулю во всех узлах интерполирования. Выберем константу $K$ так, чтобы $\varphi(x) = 0$
    \begin{equation*}
        K = \frac{f(x) - Q_m(x)}{\omega(x)} = \frac{R_m(x)}{\omega(x)}
    \end{equation*}
    Таким образом, $\varphi(z)$ имеет по меньшей мере $m + 2$ нуля (все узлы интерполирования и точка $x$).
    Тогда по теореме Ролля первая производная $\varphi(z)$ имеет по меньшей мере $m+1$ нуль, вторая производная
    -- не менее $m$ нулей, а $(m+1)$-я производная $\displaystyle \varphi^{(m+1)}(z)$ имеет по меньшей мере один нуль.
    Обозначим такую точку за $\eta$. Тогда, последовательно дифференцируя~\eqref{eq:lagrange_proof_help_func}, получаем
    \begin{equation*}
        \varphi^{(m+1)}(\eta) = f^{(m+1)}(\eta) - 0 - K(m+1)!\, = 0
    \end{equation*}
    Подставляя в это равенство выражение для $K$, получаем формулу для $R_m(x)$, совпадающую с ожидаемой.
\end{theorem}

Эта теорема позволяет сделать очевидный, но важный вывод. Пусть $f(x)$ -- это полином степени $m$.
Тогда $f^{(m+1)}(\eta) = 0$. Следовательно, полином степени $m$ \emph{однозначно} воспроизводится интерполяционным
полиномом по $m+1$ точке. Ясно также, что остаточный член во всех узлах интерполирования равен нулю.

В заключение стоит отметить, что, хотя о расположении точки $\eta$ ничего не известно, очевидна зависимость
величины $\eta$ как от узлов интерполирования, так и от точки $x$, где оценивается погрешность, т.е. $\eta = \eta(x)$.

Остаточный член позволяет оценивать отклонение $L_m(x)$ от $f(x)$ для дифференцируемых функций тогда, когда удается оценить
$\displaystyle f^{(m_1)}(x)$. Полагая $\displaystyle M_{m+1} = \max | f^{(m+1)}(x) |$, получим $\displaystyle R_m(x) \leq \frac{M_{m+1}}{(m+1)!} |\omega(x)|$.
