\section{Общий подход к построению квадратурных формул. Квадратурные формулы Ньютона-Котеса, Чебышева, Гаусса.}\label{sec:ch10}

\subsection{Общий подход к построению квадратурных формул.}
\emph{Заметим, что} все полученные выше простейшие квадратурные формулы имеют следующий вид
\begin{equation}
    \int_a^b f(x)dx \approx \sum_{k=1}^{S} A_k f(x_k) \label{eq:quad_common_def}
\end{equation}

\emph{Узлы} $x_k$ и \emph{веса} $A_k$ квадратурной формулы получались на основе интегрирования соответствующих
интерполяционных полиномов. Поставим задачу несколько иначе. Требуется выбрать узлы и веса так, чтобы
формула~\eqref{eq:quad_common_def} была бы \emph{точной} для полиномов заданной степени. Логика таких требований
очевидна. Если подынтегральная функция хорошо аппроксимируется этим полиномом, то и формула~\eqref{eq:quad_common_def}
обеспечит требуемую погрешность решения задачи. В противном случае, промежуток $[a, b]$ всегда можно разбить на
достаточно малые промежутки и применить составные квадратурные формулы.

Потребуем, чтобы формула~\eqref{eq:quad_common_def} была бы точна для полинома нулевой степени $f(x) = \alpha = const$. Вынося
константу $\alpha$ из-под знаков интеграла и суммы и сокращая на нее, имеем
\begin{equation*}
    \sum_{k=1}^{S} A_k = b - a
\end{equation*}

Второе уравнение получим, требуя точности для полинома первой степени и поставляя с этой целью
$f(x) = x$.
\begin{equation*}
    \sum_{k=1}^{S} A_k x_k = \frac{b^2 - a^2}{2}
\end{equation*}
Это же требование для $\displaystyle f(x) = x^2$ выглядит следующим образом
\begin{equation*}
    \sum_{k=1}^{S} A_k x_k^2 = \frac{b^3 - a^3}{3}
\end{equation*}
а в общем случае для $f(x) = x^N$ условие с номером $N + 1$ имеет вид
\begin{equation*}
    \sum_{k=1}^{S} A_k x_k^N = \frac{b^{N+1} - a^{N+1}}{N+1}
\end{equation*}

Объединяя все уравнения, получим систему из $N+1$ уравнения относительно $2S$ неизвестных $x_k$ и $A_k$. Эта система
является общей для многих семейств квадратурных формул, отличающихся друг от друга дополнительными условиями,
накладываемыми на $x_k$ и $A_k$.

\subsection{Квадратурные формулы Ньютона-Котеса}
Узлы квадратурной формулы здесь выбираются равноотстоящими
\begin{equation*}
    h=\frac{b-a}{S-1}, \qquad x_k = a + (k-1)h, \qquad x_1 = a \quad x_S = b
\end{equation*}
В данном случае система является линейной относительно $S$ неизвестных $A_k$ и легко решаема. Ее определитель является
определителем Вандермонда, что обеспечивает единственность решения. Для составных квадратурных формул при удвоении $N$
(числа внутренних промежутков) в половине возникающих узлов $x_k$ значения функции $f(x_k)$ уже вычислялись ранее и могли
быть сохранены, что позволяет сократить объем вычислений вдвое.

Как результат, имеем систему из $S$ уравнений с $S$ неизвестными $A_k$, и эти квадратурные формулы оказываются
гарантированно точными для полиномов степени $N = S - 1$.

\emph{Заметим, что}, решая систему последовательно для $S = 1, 2, 3$, можно прийти к уже знакомым формулам
прямоугольников, трапеций и Симпсона.

\subsection{Квадратурные формулы Чебышева}
Когда значения $f(x_k)$ определены с заметной погрешностью, удобно установить равные веса и решать задачу только
относительно $x_k$.
\begin{equation*}
    \int_{a}^{b} f(x)dx \approx A \sum_{k=1}^{S} f(x_k)
\end{equation*}

Получаем систему из $S + 1$ уравнения относительно такого же числа неизвестных $x_k$ ($S$) и $A$ ($+1$), что позволяет в
случае успешного решения получить формулы, гарантированно точные для полиномов степени $N = S$. Однако, учитывая
нелинейность системы, вопросы существования и единственности выходят на первый план. Оказывается, что система решается
единственным образом для $S \in [1; 7] \cup \left\{ 9 \right\} $. С.Н.Берштейном было показано, что для других значений $S$
формулы Чебышева не существуют.

\subsection{Квадратурные формулы Гаусса}

В этих формулах на узлы и веса не накладываются никакие дополнительные условия, и все свободные $2S$ параметров
используются при решении системы из $2S$ уравнений. В отличии от формул Чебышева, формулы Гаусса существуют для любого
числа узлов. Они гарантированно точны для полиномов степени $N = 2S - 1$ и называются \emph{формулами наивысшей
алгебраической степени точности}.
\vspace{10pt}

На практике, для получения $A_k$ и $x_k$ нет никакой необходимости обращаться к системе. Результаты ее решения для
промежутков $[-1, 1]$ и $[0, 1]$ приведены в различных справочниках, а пользователю достаточно лишь воспользоваться
заменой переменных в~\eqref{eq:quad_common_def}. Так для промежутка $[-1, 1]$ эта замена выглядит следующим образом:
$\displaystyle x = \frac{a + b}{2} + \frac{b - a}{2}t$. При изменении значений $t$ от $-1$ до $1$, переменная $x$
пробегает значения от $a$ до $b$. Учитывая $\displaystyle dx = \frac{b-a}{2}dt$, формула~\eqref{eq:quad_common_def}
имеет вид
\begin{equation}
    \int_{a}^{b} f(x)dx = \frac{b-a}{2}\int_{-1}^{1} f\left( \frac{a+b}{2} + \frac{b-a}{2}t \right)dt \approx \frac{b-a}{2}\sum_{k=1}^{S} A_k f\left( \frac{a+b}{2} + \frac{b-a}{2}t_k \right)\label{eq:quad_common_def_2}
\end{equation}
где веса $A_k$ и узлы $t_k$ берутся из справочника.
