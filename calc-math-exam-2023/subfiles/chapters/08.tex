\section{Сплайн-интерполяция. Подпрограммы \textbf{SPLINE} и \textbf{SEVAL}. Интерполирование по Эрмиту. Обратная задача интерполирования.}\label{sec:ch08}

\subsection{Интерполирование сплайнами.}
На практике интерполяционные полиномы высоких степеней строят крайне редко.
Это связано с тем, что их коэффициенты крайне чувствительны к погрешностям
исходных данных. Сравнительно малое изменение узлов интерполирования $x_k$
или значений функции $f(x_k)$ приводит к сильному изменению вида самого
полинома. Одним из возможных решений является разбиение большой исходной
таблицы на участки, для каждого из которых строится интерполяционный полином
относительно невысокой степени. Однако, в основном требуется, чтобы
аппроксимирующая функция была гладкой, а функция, составленная из различных
полиномов, в узлах сопряжения не имеет производной. Выходом из положения
является использование сплайн-интерполяции. Вообще, сплайн -- это некий
инструмент, используемый при построении чертежей. Дадим математической
модели более формальное определение.
\vspace{10pt}

Обратимся к таблично заданной функции: $\displaystyle X = \left\{x_1,\dots,x_N\right\},\,F = \left\{f(x)\,|\, x \in X\right\}$.
Число узлов равно $N$, а их нумерация начинается с единицы. На каждом промежутке $\displaystyle \left[x_k, x_{k+1}\right]$
будем строить интерполяционный полином третьей степени
\begin{equation}
    S_k(x_{k+1}) = a_k + b_k \left( x - x_k \right) + c_k \left( x - x_k \right)^2 + d_k \left( x - x_k \right)^3\label{eq:spline_def}
\end{equation}

Количество полиномов, как и промежутков, равно $N - 1$, и каждый полином имеет 4 параметра.
Таким образом, всего в наличии $4N - 4$ параметра. Потребуем, чтобы во всех внутренних точках
были равны значения соседних полиномов, их первых и вторых производных.
\begin{equation*}
    \begin{cases}
        \displaystyle S_k(x_{k+1}) = S_{k+1}(x_{k+1})\\
        S_k'(x_{k+1}) = S_{k+1}'(x_{k+1})\\
        S_k''(x_{k+1}) = S_{k+1}''(x_{k+1})\\
    \end{cases}
    \qquad k = 1,\dots,N-2
\end{equation*}
То есть выполнялось суммарно $3(N-2) = 3N - 6$ уравнений. Еще $N$ уравнений отражают требования
интерполирования
\begin{equation*}
    \displaystyle S_k(x_k) = f_k; \qquad k = 1, \dots, N-1; \qquad S_{N-1}(x_N) = f_N
\end{equation*}
Общее число задаваемых уравнений достигает $4N - 6$. При наличии $4N - 4$ параметров
появляется возможность выполнить еще два условия. Их задание необязательно -- все требования
интерполяции и сопряжения соседних полиномов уже выполнены, но это целесообразно сделать для
однозначного решения задачи. Различные кубические сплайны отличаются друг от друга этим заданием
этих двух требований, которые, как правило, записываются для двух крайних точек $x_1 \text{ и } x_N$.
К этим двум дополнительным условиям целесообразно выдвинуть следующие два требования. С одной стороны,
их лучше задавать так, чтобы полная система уравнений решалась по возможности более просто. С другой
стороны, они должны максимально соответствовать характеру поведения функции в начале и в конце
промежутка интерполирования. Рассмотрим на примерах.
\vspace{10pt}

\emph{Пример 1.} $\displaystyle S_1''(x_1) = 0; \quad S_{N-1}''(x_N) = 0$. Этот сплайн получил название
\emph{естественного кубического сплайна}. Такие условия и название оправдываются только при использовании в механике.
В общем случае равенство нулю второй производной на краях промежутка не является обязательным свойством
экспериментальных данных, отражаемых таблицей.
\emph{Пример 2.} По первым четырем точкам таблицы строится интерполяционный полином третьей степени
$Q_3(x)$, и его третья производная приравнивается третьей производной $S_1(x)$. Аналогично, по
последним четырем точкам строится интерполяционный полином $\tilde{Q_3}(x)$, и его третья
производная приравнивается третьей производной последнего полинома $S_{N-1}(x)$.
\begin{equation*}
    \displaystyle Q_3'''(x_1) = S_1'''(x_1); \qquad \tilde{Q_3}'''(x_N) = S_{N-1}'''(x_N)
\end{equation*}
Такие условия не только отвечают характеру поведения функции в начале и в конце промежутка интерполирования,
но и достаточно просты (третья производная от полинома третьей степени постоянна). Именно они и
учитываются в рассматриваемых программах \verb|SPLINE| и \verb|SEVAL|.

\subsection{Подпрограммы \bf{SPLINE} и \bf{SEVAL}.}
Первая из них -- \verb|SPLINE(N, X, F, B, C, D)|, оформленная как процедура, решает систему
уравнений относительно $b_k, c_k, d_k$.

\bf{N} -- число точек;

\bf{X}, \bf{F} -- векторы, элементами которых являются $x_k$ и $f_k$;

\bf{B}, \bf{C}, \bf{D} -- векторы с коэффициентами $b_k, c_k, d_k$ полиномов~\eqref{eq:spline_def} --
результаты работы \verb|SPLINE|.
\vspace{10pt}

Вторая программа \verb|SEVAL(N, U, X, F, B, C, D)|, оформленная как функция, использует
результаты работы \verb|SPLINE| и вычисляет значение сплайна в заданной точке \bf{U}.

\subsection{Интерполирование по Эрмиту.}
До этого интерполяция происходила по значениям функции. Если в таблице помимо значений функции
присутствуют ее производные и от интерполяционного полинома требуется совпадение с данными этой
таблицы, то такая задача называется \emph{интерполирование по Эрмиту}. Рассмотрим пример.

Для следующих входных данных требуется построить интерполяционный полином, удовлетворяющий
всем условиям таблицы.
\begin{table}[H]
    \centering
    \begin{tabular}{|c|c|c|c|}
        \hline
        $x$      & $x_0$       & $x_1$      & $x_2$       \\ \hline
        $f(x)$   & $f(x_0)$    & $f(x_1)$   & $f(x_2)$    \\ \hline
        $f'(x)$  & $f'(x_0)$   & $f'(x_1)$  & \textemdash \\ \hline
        $f''(x)$ & \textemdash & $f''(x_1)$ & \textemdash \\ \hline
    \end{tabular}
\end{table}

Выпишем таблицу в виде системы уравнений:
\begin{equation}
    \begin{cases}
        H(x_k) = f(x_k), \quad k = 0, 1, 2 \\
        H'(x_k) = f'(x_k), \quad k = 0, 1 \\
        H''(x_k) = f''(x_k), \quad k = 1
    \end{cases}
    \label{eq:hermit1}
\end{equation}
Система~\eqref{eq:hermit1} содержит 6 уравнений. Для ее однозначного решения полином $H(x)$
должен иметь 6 коэффициентов, т.е. быть полиномом пятой степени. Общее правило очевидно:
степень интерполяционного полинома Эрмита на единицу меньше общего числа условий таблицы.
Вспоминая случай с полиномом Лагранжа, для построения которого решение системы оказалось
необязательным, возникает вопрос -- нельзя ли и полином Эрмита воспроизвести сразу в готовом
виде? Ответ оказывается положительным, однако общая формула довольна громоздка. Форма записи
будет проще, если исходная система симметрична, т.е. число и вид условий во всех узлах
одинаковые.

Полином Эрмита второй степени
\begin{equation*}
    H_2(x) = f(x_0) + \frac{x - x_0}{1!}f'(x_0) + \frac{\left( x - x_0 \right)^2}{2!}f''(x_0)
\end{equation*}
с одной стороны является частичной суммой ряда Тейлора, а с другой удовлетворяет условиям
\begin{equation*}
    H_2(x_0) = f(x_0); \qquad H_2'(x_0) = f'(x_0); \qquad H_2''(x_0) = f''(x_0)
\end{equation*}
что позволяет назвать его еще и интерполяционным полиномом Эрмита с одним узлом интерполирования.

\subsection{Обратная интерполяция.}
До этого была рассмотрена так называемая \emph{прямая} задача интерполирования, в рамках которой
по заданному значению $x^{*}$ требовалось оценить значение функции $f(x^{*})$. В обратной же задаче
для такой же таблицы требуется восстановить такое значение аргумента, при котором функция принимает
заданное значение. На практике чаще всего используется один из следующих способов.

\emph{Способ 1}. Меняются местами строки таблицы, в качестве узлов интерполирования выступают
значения функции, по которым строится интерполяционный полином для обратной функции. Подставляя
в него данное $f^{*}$ находим искомый $x^{*}$. Такой подход возможен, если обратная функция на
заданном участке интерполирования существует, то есть исходная функция строго монотонна, что
бывает совсем не всегда.

\emph{Способ 2}. По исходной таблице строится обычный интерполяционный полином $Q_m(x)$ с
узлами $x_k$, а затем решается уравнение $Q_m(x) = f^{*}$. Для полиномов до 4 степени
ответ может быть получен даже аналитически, а в других случаях это уравнение решается численно.
В случае немонотонной функции, краевом для предыдущего способа, в этот раз будет найдено несколько
корней, из которых необходимо будет выбрать отвечающий поставленной задаче.
