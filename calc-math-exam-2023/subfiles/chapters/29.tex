\section{Сведение дифференциального уравнения высокого порядка к системе уравнений первого порядка. Метод стрельбы для решения краевых задач.}\label{sec:ch29}

\subsection{Сведение дифференциального уравнения высокого порядка к системе уравнений первого порядка.}
Эту процедуру рассмотрим на примере линейного дифференциального уравнения четвертого порядка с постоянными
коэффициентами
\begin{equation}
    \frac{d^4 z(t)}{dt^4} + \alpha_1\frac{d^3 z(t)}{dt^3} + \alpha_2\frac{d^2 z(t)}{dz^2} + \alpha_3\frac{dz(t)}{dt} + \alpha_4 z(t) = \varphi(t)
    \label{eq:highlvldiffeq}
\end{equation}
Характеристическое уравнение для него имеет вид
\begin{equation}
    \uplambda^4 + \alpha_1 \uplambda^3 + \alpha_2 \uplambda^2 + \alpha_3 \uplambda + \alpha_4 = 0
    \label{eq:char_highlvldiffeq}
\end{equation}
Если среди корней уравнения~\eqref{eq:char_highlvldiffeq} нет кратных, то решение неоднородного уравнения~\eqref{eq:highlvldiffeq}
определяется линейной комбинацией экспонент, показателями которых являются корни уравнения~\eqref{eq:char_highlvldiffeq},
и частным решением уравнения~\eqref{eq:highlvldiffeq}, определяемым видом функции $\varphi(t)$.

Введем вектор \bf{x} четвертого порядка со следующими компонентами
\begin{equation*}
    \bf{x} =
    \begin{pmatrix}
        \displaystyle x^{(1)} & \displaystyle x^{(2)} & \displaystyle x^{(3)} & \displaystyle x^{(4)}
    \end{pmatrix}^T
    =
    \begin{pmatrix}
        \displaystyle \frac{d^3 z(t)}{dt^3} & \displaystyle \frac{d^2 z(t)}{dt^2} & \displaystyle \frac{dz(t)}{dt} & \displaystyle z
    \end{pmatrix}^T
\end{equation*}
Тогда вместо уравнения~\eqref{eq:highlvldiffeq} можно записать систему уравнений
\begin{flalign*}
    &\displaystyle \frac{dx^{(1)}}{dt} = -\alpha_1 x^{(1)} -\alpha_2 x^{(2)} -\alpha_3 x^{(3)} -\alpha_4 x^{(4)} + \varphi(t) \\
    &\displaystyle \frac{dx^{(2)}}{dt} = x^{(1)}\\
    &\displaystyle \frac{dx^{(3)}}{dt} = x^{(2)}\\
    &\displaystyle \frac{dx^{(4)}}{dt} = x^{(3)}
\end{flalign*}
Она же в векторно-матричной форме имеет вид
\begin{equation}
    \frac{d\bf{x}}{dt} = \bf{A} \cdot \bf{x} + \bf{f}(t)
    \label{eq:sys_highlvldiffeq}
\end{equation}
где
\begin{equation*}
    A =
    \begin{pmatrix}
        \displaystyle -\alpha_1 & \displaystyle -\alpha_2 & \displaystyle -\alpha_3 & \displaystyle -\alpha_4 \\
        1                       & 0                       & 0                       & 0                       \\
        0                       & 1                       & 0                       & 0                       \\
        0                       & 0                       & 1                       & 0
    \end{pmatrix}
    , \qquad \bf{f}(t) =
    \begin{pmatrix}
        \varphi(t) & 0 & 0 & 0
    \end{pmatrix}^T
\end{equation*}
Матрица \bf{A} называется \emph{матрицей Фробениуса}. При этом, решение системы~\eqref{eq:sys_highlvldiffeq}
описывается линейной комбинацией экспонент, показателями которых являются собственные значения матрицы \bf{A}, и
частным решением уравнения~\eqref{eq:sys_highlvldiffeq}, определяемым видом функции $\bf{f}(t)$.

Таким образом, вместо поиска корней полинома~\eqref{eq:char_highlvldiffeq} можно искать собственные значения
матрицы Фробениуса, что на практике часто так и делается.

В случае, когда уравнение высокого порядка является нелинейным,
\begin{equation*}
    \frac{d^4 z(t)}{dt^4} = F\left( t, \frac{d^3 z(t)}{dt^3}, \frac{d^2 z(t)}{dt^2}, \frac{dz(t)}{dt}, z(t) \right)
\end{equation*}
описанная выше замена переменных сохраняется:
\begin{gather*}
    \frac{dx^{(1)}}{dt} = F\left( t, x^{(1)}, x^{(2)}, x^{(3)}, x^{(4)} \right), \\
    \dots
\end{gather*}
Для решения этой системы можно использовать любую программу, реализующую ранее рассмотренные методы, в частности,
программу \verb|RKF45|.

\subsection{Метод стрельбы для решения краевых задач.}
В рассмотренной ранее задаче Коши одно из решений системы выделяется заданием начальных условий $(t_0, \bf{x}_0)$.
Однако это не единственный способ. Задавая условия при двух или более значениях независимой переменной, приходим к
краевой задаче. В общем случае краевые (граничные) условия выглядят следующим образом:
\begin{equation*}
    \Phi_i \left( x^{(1)}(t_k),\ldots, x^{(m)}(t_k) \right) = 0, \qquad a \leq t_k \leq b, \qquad 1 \leq i \leq m
\end{equation*}
В зависимости от вида уравнения и краевых условий можно провести классификацию краевых задач, схожую с классификацией
краевых задач Коши. Важным подклассом являются линейные краевые задачи, когда и система и краевые условия являются
линейными. Эти условия имеют вид
\begin{equation*}
    \alpha_i x^{(1)}(t_k) + \beta_i x^{(2)} + \ldots + \omega_i(t_k)x^{(m)}(t_k) = a_i, \qquad i \leq m
\end{equation*}
Линейная краевая задача является однородной, если однородны уравнения и краевые условия. Такая задача всегда имеет
тривиальное решение $\bf{x}(t) \equiv 0$, и в этом случае представляет интерес отыскание нетривиальных решений.

В свою очередь, из краевых задач выделяют двухточечные, когда условия задаются на левом и правом концах промежутка,
т.е. при $t_k = a$ и $t_k = b$. Например, дифференциальное уравнение второго порядка
\begin{gather*}
    -\frac{d}{dt} \left( p(t)\frac{dx(t)}{dt} \right) + q(t)x(t) = f(t)\\
    t \in [0, 1], \qquad p(t) \geq p_0 > 0, \quad q(t) > 0
\end{gather*}
где краевые условия $x(0) = x(1) = 0$ определяют задачу, которая является моделью многих физических процессов:
распределение тепла в неоднородном стержне, распределение концентрации вещества в процессах диффузии и др.

Несмотря на разнообразие форм краевых условий, краевые задачи в основном решаются одними и теми же численными методами.
Выделяют два основных подхода:
\begin{enumerate}
    \item Сведение к многократному решению задачи Коши;
    \item Сведение к решению алгебраических систем.
\end{enumerate}
Второй подход включает в себя как конечно-разностные, так и проекционные методы. К последним относятся, в свою очередь,
давно применяющиеся методы коллокаций, Галеркина, Ритца, а также метод конечных элементов.
\vspace{10pt}

Многократное решение задачи Коши демонстрирует метод стрельбы, имеющий аналогию со стрельбой, когда, зафиксировав
недолет или перелет, угол стрельбы изменяют так, чтобы следующий выстрел был ближе к цели. Рассмотрим систему из
двух уравнений
\begin{equation*}
    \frac{du}{dt} = f_1(t, u, v) \qquad \frac{dv(t)}{dt} = f_2(t, u, v), \qquad t \in [a, b]
\end{equation*}
с граничными условиями
\begin{equation*}
    v(a) = v_a, \quad u(b) = u_b
\end{equation*}

Выберем произвольное значение $\displaystyle u_a = u(a)$. С начальными условиями $\displaystyle u_a \text{ и } v_a$
проинтегрируем систему каким-либо методом. Результатом будут функции $\displaystyle u(t, u_a) \text{ и } v(t, u_a)$,
зависящие от $\displaystyle u_a$ как от параметра. При подстановке $\displaystyle u(b, u_a)$ в правое краевое условие
получаем функцию относительно $\displaystyle u_a$. Задача свелась к нахождению решения уравнения $\displaystyle L(u_a) = 0$,
где $\displaystyle L(u_a) = u(b, u_a) - u_b$.

Конкретный вид функции $\displaystyle L(u_a)$ неизвестен, но значения ее для любых значений $\displaystyle u_0$
легко вычисляются, и это дает возможность воспользоваться любым методом нахождения корней нелинейного уравнения. Так,
в частности, можно воспользоваться уже известной процедурой-функцией \verb|ZEROIN(A, B, F, EPS)|.
\vspace{5pt}

Основная программа вызывает \verb|ZEROIN|. Предварительно подбираются два значения $\displaystyle u_a = A$ и
$\displaystyle u_a = B$, для которых функция $\displaystyle L(u_a)$ имеет различный знак. Программа \verb|ZEROIN|
вызывает функцию $\displaystyle L(u_a)$, которую программирует пользователь. Эта функция, в свою очередь, обращается
к программе \verb|RKF45|, которая вызывает процедуру, вычисляющую $\bf{f}(t, \bf{x})$. Значение функции
$\displaystyle L(u_a)$ для заданного $\displaystyle u_a$ определяется выражением $\displaystyle L(u_a) = u(b, u_a) - u_b$.

Описанная ситуация резко упрощается, если задача является линейной двухточечной краевой
\begin{gather*}
    \frac{du}{dt} = p_1(t)u(t) + q_1(t)v(t) + s_1(t)\\
    \frac{dv}{dt} = p_2(t)u(t) + q_2(t)v(t) + s_2(t)\\
\end{gather*}
с граничными условиями
\begin{equation*}
    v(a) = v_a, \quad u(b) = u_b
\end{equation*}
В силу линейности задачи решение будет зависеть от $u(a)$ линейно, и функция $\displaystyle L(u_a)$ также будет
линейной. Отсюда следует, что для вычисления $\displaystyle u_a^*$ -- левого начального условия для функции $u(t)$,
дающего решение краевой задачи, достаточно дважды проинтегрировать систему до $t = b$ с двумя различными начальными
условиями $\displaystyle (u_a^1, v_a^1)$ и $\displaystyle (u_a^2, v_a^2)$, найти $\displaystyle L\left( u_a^1 \right)$
и $\displaystyle L \left( u_a^2 \right)$ и линейной интерполяцией определить $\displaystyle u_a^*$. Таким образом,
$\displaystyle u_a^*$ будет корнем уравнения
\begin{equation*}
    \frac{u_a - u_a^2}{u_a^1 - u_a^2}L\left( u_a^1 \right) + \frac{u_a - u_a^1}{u_a^2 - u_a^1}L\left( u_a^2 \right) = 0.
\end{equation*}
